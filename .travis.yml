language: go
sudo: required
go:
- "1.14.3"
env:
  - GO111MODULE=on
before_install:
  - wget https://github.com/google/protobuf/releases/download/v3.7.0/protoc-3.7.0-linux-x86_64.zip
  - unzip protoc-3.7.0-linux-x86_64.zip -d $HOME
  - export PATH=$HOME/protoc-3.7.0-linux-x86_64/bin:$PATH
script:
  - make build OUTFILE=pganalyze-collector-linux-amd64
  - make test
  - make integration_test
